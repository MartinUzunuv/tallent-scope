<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Writenhire</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- <link rel="icon" href="/logo.png" type="image/x-icon" /> -->
    <!-- <link rel="shortcut icon" href="/logo.png" type="image/x-icon" /> -->
    <style>
      #navbar {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
      }

      #main {
        display: flex;
        flex-wrap: wrap;
      }

      body {
        font-family: Arial, Helvetica, sans-serif;
        margin: 0px;
      }

      .accountForm {
        background-color: #f5b721;
        border: solid black 2px;
        color: #1c1f22;
        display: flex;
        flex-direction: column;
        text-align: center;
        margin: 40px;
        max-width: 80%;
        width: 350px;
        margin-top: 80px;
        padding: 40px;
        border-radius: 10px;
      }

      .accountForm input:not([type="submit"]) {
        padding: 10px;
        border-radius: 6px;
        border: solid 1px rgb(158, 158, 158);
        margin-top: 30px;
      }

      .centerAccountForm {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 95%;
      }

      .accountFormSubmit {
        background-color: #212529;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 18px;
        margin-top: 35px;
      }

      .accountFormSubmit:hover {
        box-shadow: 0px 0px 5px 1px rgba(0, 0, 0, 0.75);
        cursor: pointer;
      }

      #dontHaveAnAccountSignUp {
        text-align: left;
        color: black;
        text-decoration: underline;
        cursor: pointer;
      }

      #forgotPassSignUp {
        text-align: left;
        color: black;
        text-decoration: underline;
        cursor: pointer;
      }

      #main {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
      }

      @media screen and (min-width: 1038px) {
        /* .mainFormAndDescription {
          width: 43% !important;
        } */

        #mainForm {
          width: 29% !important;
        }

        #jobDescription {
          width: 58% !important;
        }
      }

      #mainForm {
        width: 90%;
      }

      #jobDescription {
        width: 90%;
      }

      h2 {
        font-weight: 600;
      }

      .mainFormAndDescription {
        /* width: 90%; */
        min-width: 100px;
        padding: 15px;
        color: white;
        border: none;
        border-radius: 6px;
        margin: 10px;
      }

      .warningMsg {
        background-color: rgba(255, 30, 30, 0.6);
        text-align: left;
        padding: 8px;
        border-radius: 5px;
      }

      #mainForm {
        text-align: center;
      }

      #mainForm input::placeholder {
        text-align: center;
        color: #4c5c6b;
      }

      #mainForm input {
        background-color: white;
        color: #5c6771;
        border: none;
        padding: 10px;
        margin: 0px 10px 10px 10px;
        border-radius: 3px;
        border: solid #dcdcdc 1px;
        width: 85%;
        font-weight: 900;
      }

      #mainForm input:required {
        background-color: #f7f7f7;
        color: #4c5c6b;
      }

      /* #mainForm input:required::placeholder {
        color: white;
      } */

      #mainFormQuestionsQuestion {
        text-align: center;
      }

      #submitClearGroup {
        display: flex;
        justify-content: space-evenly;
      }

      #submitClearGroup button {
        width: 30%;
        padding: 5px;
        border-radius: 5px;
        border: none;
        font-weight: 800;
        font-size: small;
      }

      #jobDescriptionClear {
        /* border: solid 1.5px #cf5068 !important; */
        background-color: #f7dade;
        color: #1f3245;
        margin-left: 10px;
        margin-right: 10px;
        flex-grow: 1;
      }

      #jobDescriptionClear:hover {
        box-shadow: 0px 0px 5px 1px rgba(0, 0, 0, 0.75);
      }

      #jobDescriptionCopy {
        width: 30%;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 5px;
        border-radius: 5px;
        border: none;
        font-weight: 800;
        font-size: small;
        border: solid 1.5px #1f3245 !important;
        background-color: white;
        color: #1f3245;
        text-align: center;
        margin-left: 10px;
        margin-right: 10px;
        flex-grow: 1;
        background-color: black;
        color: white;
      }

      #jobDescriptionCopy:hover {
        box-shadow: 0px 0px 5px 1px rgba(0, 0, 0, 0.75);
      }

      #mainFormSubmit {
        width: 30%;
        height: 40px;
        padding: 5px;
        border-radius: 5px;
        border: none;
        font-weight: 800;
        font-size: small;
        background-color: #50ab4a;
        color: white;
        flex-grow: 2;
        margin-left: 10px;
        margin-right: 10px;
      }

      #mainFormSubmit:hover {
        box-shadow: 0px 0px 13px 2px rgba(0, 0, 0, 0.75);
      }

      #jobDescriptionResult {
        background-color: white;
        color: black;
        margin-top: 20px;
        padding: 10px;
        width: 100%;
        min-height: 800px;
        border: solid 2px black;
        border-radius: 7px;
      }

      #jobDescriptionResultcontainer {
        display: flex;
        justify-content: center;
      }

      #mainFormSubmit:disabled {
        background-color: #ad903a;
      }

      /* Dropdown Button */
      .dropbtn {
        background-color: #ffffff;
        color: #1f3245;
        display: flex;
        justify-content: center;
        width: 30%;
        border: none;
        padding: 10px;
        /* padding-bottom: 15px; */
        cursor: pointer;
        margin-left: 10px;
        margin-right: 10px;
        /* max-height: 35.33px; */
        border: solid #1f3245 1px;
        border-radius: 4px;
        font-weight: 900;
        font-size: 14px;
      }

      /* Dropdown button on hover & focus */
      /* .dropbtn:hover,
      .dropbtn:focus {
        background-color: #3b464f;
      } */

      /* The container <div> - needed to position the dropdown content */
      .dropdown {
        position: relative;
        display: inline-block;
      }

      /* Dropdown Content (Hidden by Default) */
      .dropdown-content {
        /* display: none;
        position: absolute; */
        background-color: #f1f1f1;
        min-width: 160px;
        /* box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2); */
        z-index: 1;
      }

      /* Links inside the dropdown */
      .dropdown-content a {
        color: black;
        /* padding: 12px 16px; */
        text-decoration: none;
        display: block;
        font-size: 13.3;
        width: 240px;
        margin: none;
        padding: 4px;
        background-color: #ffffff;
      }

      /* Change color of dropdown links on hover */
      .dropdown-content a:hover {
        background-color: #d9d9d9;
      }

      /* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
      .show {
        display: block;
      }

      #lang {
        background-color: white;
        color: #4c5c6b;
        border: solid black 2px;
        border-radius: 3px;
        padding: 10px;
        width: 210px;
        margin-right: 25px;
        margin-top: 9px;
        font-size: 12px;
        font-weight: 900;
      }

      #lang > option {
        background-color: white;
        color: #4c5c6b;
        border: none;
        padding: 10px;
        margin: 10px;
        width: 182px;
        border-radius: 0px;
      }

      #lang::-ms-expand {
        border-radius: 0px;
      }

      #navbarTitle {
        font-size: 22px;
      }

      #navbar {
        background-color: #eeb120;
        border: solid black 3px;
      }

      #navbarEmailBox {
        display: flex;
        align-items: baseline;
        justify-content: flex-end;
        margin-right: 30px;
      }

      /* @media screen and (max-width: 436px) {
        .dropbtn {
          padding-bottom: 40px;
        }

        #openMyAccount {
          padding-bottom: 10px !important;
        }
      } */

      #openMyAccount {
        background-color: #eeb120;
        border: solid black 2px;
        border-radius: 50px !important;
        padding: 7px;
        padding-left: 30px;
        padding-right: 30px;
        font-weight: 900;
        margin: 10px;
        cursor: pointer;
        /* font-size: 15px; */
      }

      #openMyAccount:hover {
        box-shadow: 0px 0px 5px 1px rgba(0, 0, 0, 0.75);
      }

      .loader {
        border: 6px solid #f3f3f3; /* Light grey */
        border-top: 6px solid #f8d23c; /* Blue */
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 2s linear infinite;
        margin-top: 30px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      #historyOpenButton {
        cursor: pointer;
        height: 100%;
        width: 250px;
        border-right: black solid 4px;
        border-bottom: none;
        border-top: none;
        border-left: none;
        background-color: unset;
        font-size: 15px;
        font-weight: 900;
      }

      #historySpace {
        /* width: 250px; */
        /* height: 200px; */
        border: solid black 4px;
        /* border-bottom: none; */
        border-top: none;
        border-left: none;
        transition: 0.5s;
        height: 100vh;
        background-color: white;
      }

      #appSpace {
        display: flex;
        flex-wrap: nowrap;
        flex-direction: row;
      }

      #formName {
        flex-grow: 1;
      }

      #histotyItem {
        transition: 0.5s;
        border: solid rgb(186, 186, 186) 0.5px;
        border-top: none;
        border-left: none;
        border-right: none;
      }

      * {
        transition: 0.5s;
      }

      /* #blackout {
        position: absolute;
        background-color: rgba(0, 0, 0, 0.25);
        width: 10000px;
        height: 10000px;
        position: fixed;
        margin-top: -100px;
      } */

      #PageTitle {
        color: white;
        font-weight: 500;
        font-size: 40px;
        margin-top: 5px;
      }

      .dropbtn:hover {
        box-shadow: 0px 0px 5px 1px rgba(0, 0, 0, 0.75);
      }

      .labelForInputs {
        color: black;
        font-weight: 900;
        font-size: 13px;
        margin-top: 10px;
        display: flex;
        justify-content: center;
      }

      @media screen and (max-width: 720px) {
        #PageTitle {
          display: none;
        }
      }

      .accountButton {
        background-color: white;
        border: solid 1px rgb(130, 130, 130);
        text-align: center;
        width: 300px;
        font-weight: 800;
        font-size: 15px;
        margin: 30px;
        padding: 15px;
        margin-bottom: 5px;
      }

      #myAccount {
        background-color: #d6e6f5;
      }

      /* Payment styles */
      .all-payments {
        width: 100%;
        height: 100%;
        font-family: Arial, sans-serif;
        background: #f4f4f4;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        gap: 20px;
      }
      .plans{
        display: flex;
      }
      .back-button{
        display: flex;
      }
      .card-h2{
        font-size: 25px;
        font-weight: bold;
      }
      .card {
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 3px rgba(0,0,0,0.1);
        margin: 0 10px;
        padding: 20px;
        width: 200px;
        height: 220px;
        text-align: center;
      }
      /* .card:hover {
        border: 2px solid #007bff;
      } */
      .card .price {
        font-size: 48px;
        margin: 20px 0;
      }
      .card .price span {
        font-size: 40px;
        vertical-align: super;
      }
      .card .select {
        background: white;
        color: black;
        padding: 10px 20px;
        text-transform: uppercase;
        text-decoration: none;
        display: inline-block;
        margin-top: 20px;
        border: 1px solid black;
      }
      .card .select:hover {
        background: black;
        color: white;
      }
      .card p {
        color: #666;
        margin: 5px 0;
      }
      .dollar-payment {
        font-size: 40px; 
      }
      .price {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .best-payment{
        width: 60%;
        background:black;
        color: white;
        font-size: 21px;
        position: relative;
        top: -30px;
        left: 50%;
        transform: translate(-50%);
        z-index: 2;
      }
      .empty-payment{
        height: 24px;
      }
      /* END */
    </style>
  </head>
  <body>
    <script>
      function validate() {
        axios
          .post(baseUrl + "/validate", {
            email: localStorage.getItem("talentScopeEmail"),
            pass: localStorage.getItem("talentScopePass"),
          })
          .then((response) => {
            const res = response.data;
            if (res.message !== "ok") {
              home.style.display = "none";
              signIn.style.display = "none";
              signUp.style.display = "none";
              fPass.style.display = "none";
              myAccount.style.display = "none";
              payments.style.display = "block";
            }
          })
          .catch((error) => {
            console.error(error);
          });
      }
      var copyText = "";
      var currentTextDbId = null;
      var historyOpened = false;
      // var baseUrl = "http://35.175.226.121:80";
      var baseUrl = "http://localhost:3000";
    </script>

    <!-- home -->
    <div id="home">
      <div id="navbar">
        <div class="dropdown">
          <button onclick="dropdownTogle()" id="historyOpenButton">
            <a
              style="
                border-radius: 200px;
                border: solid black 2px;
                padding: 4px;
                margin-right: 10px;
                padding-left: 35px;
                padding-right: 35px;
                box-sizing: border-box;
              "
              >History</a
            ><img src="historyIcon.png" width="20px" />
          </button>
        </div>
        <a id="PageTitle">write N hire</a>
        <div id="navbarEmailBox">
          <button id="openMyAccount" style="border-radius: 5px">Account</button>
          <script>
            document
              .getElementById("openMyAccount")
              .addEventListener("click", () => {
                myAccount.style.display = "block";
                home.style.display = "none";
              });
          </script>
        </div>
      </div>

      <div id="appSpace">
        <div id="historySpace">
          <div id="historyDropdown" class="dropdown-content">
            <a id="histotyItem">Loading...</a>
          </div>
        </div>
        <script>
          function dropdownTogle() {
            historyOpened = !historyOpened;
            if (window.innerWidth > 600) {
              document.getElementById("historySpace").style.position = "unset";
              if (historyOpened) {
                document.getElementById("historySpace").style.width = "248.5px";
                document.getElementById("histotyItem").style.width = "240px";
                // document.getElementById("histotyItem").style.display = "block";
                let elements = document.querySelectorAll("#histotyItem");
                setTimeout(() => {
                  elements.forEach(function (element) {
                    element.style.display = "block";
                    // element.style.marginLeft = "0px";
                  });
                }, 400);
              } else {
                document.getElementById("historySpace").style.width = "0px";
                // document.getElementById("histotyItem").style.width = "0px";
                // document.getElementById("histotyItem").style.display = "none";
                let elements = document.querySelectorAll("#histotyItem");
                elements.forEach(function (element) {
                  element.style.display = "none";
                  // element.style.marginLeft = "-240px";
                });
              }
            } else {
              document.getElementById("historySpace").style.position =
                "absolute";
              if (historyOpened) {
                document.getElementById("historySpace").style.width = "248.5px";
                document.getElementById("histotyItem").style.width = "240px";
                document.getElementById("histotyItem").style.marginLeft = "0px";

                // document.getElementById("histotyItem").style.display = "block";
                let elements = document.querySelectorAll("#histotyItem");
                elements.forEach(function (element) {
                  element.style.display = "block";
                  // element.style.marginLeft = "0px";
                });
              } else {
                document.getElementById("historySpace").style.width = "0px";
                // document.getElementById("histotyItem").style.width = "0px";
                document.getElementById("histotyItem").style.marginLeft =
                  "-240px";

                // document.getElementById("histotyItem").style.display = "none";
                let elements = document.querySelectorAll("#histotyItem");
                setTimeout(() => {
                  elements.forEach(function (element) {
                    element.style.display = "none";
                    // element.style.marginLeft = "-240px";
                  });
                }, 400);
              }
            }
          }

          // if (window.innerWidth > 600) {
          dropdownTogle();
          // }

          function refreshHistory() {
            const dropdownContent = document.getElementById("historyDropdown");
            // dropdownContent.classList.toggle("show");

            axios
              .post(baseUrl + "/getHistory", {
                email: localStorage.getItem("talentScopeEmail"),
                pass: localStorage.getItem("talentScopePass"),
              })
              .then((response) => {
                const res = response.data;
                var chats = JSON.parse(res.message);
                console.log(chats);
                dropdownContent.innerHTML = "";
                if (chats.length <= 0) {
                  var button = document.createElement("a");

                  button.innerHTML = "No history yet";

                  button.classList.add("highlighted");

                  dropdownContent.appendChild(button);

                  // clearInterval(noHistory);
                  // var noHistory = setInterval(() => {
                  //   button.innerText =
                  //     "History";
                  // }, 3000);
                }
                for (let i = chats.length; i >= 0; i--) {
                  if (i < chats.length) {
                    var button = document.createElement("a");

                    button.innerHTML = chats[i].jobTitle + " " + chats[i].date;

                    button.name = i + "-history";

                    button.classList.add("highlighted");
                    button.setAttribute("id", "histotyItem");

                    dropdownContent.appendChild(button);

                    button.addEventListener("click", (event) => {
                      let n = parseInt(event.target.name[0]);
                      console.log(event.target.name);
                      document.getElementById("jobTitle").value =
                        chats[n].jobTitle;
                      document.getElementById("aboutTheEmployer").value =
                        chats[n].aboutTheEmployer;
                      document.getElementById("salary").value = chats[n].salary;
                      document.getElementById("remote").value = chats[n].remote;
                      document.getElementById("locationText").value =
                        chats[n].locationText;
                      document.getElementById("jobType").value =
                        chats[n].jobType;
                      document.getElementById("employmentType").value =
                        chats[n].employmentType;
                      document.getElementById("description").value =
                        chats[n].description;
                      document.getElementById("requirements").value =
                        chats[n].requirements;
                      document.getElementById("keywords").value =
                        chats[n].keywords;
                      document.getElementById("skills").value = chats[n].skills;
                      document.getElementById("education").value =
                        chats[n].education;
                      document.getElementById("personality").value =
                        chats[n].personality;
                      document.getElementById("lang").value = chats[n].lang;
                      document.getElementById(
                        "jobDescriptionResult"
                      ).innerText = chats[n].assistantAnswer;
                      copyText = chats[n].assistantAnswer;
                      currentTextDbId = chats[n].id;
                      // console.log(copyText);
                    });
                  }
                }
              })
              .catch((error) => {
                console.error(error);
              });
          }

          refreshHistory();

          window.onclick = function (event) {
            if (!event.target.matches(".dropbtn")) {
              var dropdowns =
                document.getElementsByClassName("dropdown-content");
              var i;
              for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains("show")) {
                  openDropdown.classList.remove("show");
                }
              }
            }
          };
        </script>
        <form id="formName">
          <!-- <div id="blackout"></div> -->
          <div id="main">
            <div
              id="mainForm"
              class="mainFormAndDescription"
              style="margin-top: 0px; padding-top: 0px"
            >
              <!-- <p>Attract Top Candidates with AI-Generated Job Descriptions</p>
          <p>
            Input vacancy key details below and Talent Scope will create a job
            description that will rank high on any Job Board & Google For Jobs
          </p> -->
              <div id="mainFormQuestionsQuestion">
                <br />
                <!-- <div class="dropdownLang">
                <button onclick="dropdownTogle()" class="dropbtnLang">
                  History
                </button>
                <div id="historyDropdown" class="dropdown-content">
                  <a>Loading...</a>
                </div>
              </div> -->
                <div style="width: 100%; text-align: right">
                  <select name="lang" id="lang">
                    <option value="" disabled selected hidden>
                      CHOOSE LANGUAGE
                    </option>
                    <option value="english">English</option>
                    <option value="german">German</option>
                    <option value="spanish">Spanish</option>
                    <option value="french">French</option>
                    <option value="portuguese">Portuguese</option>
                    <option value="japanese">Japanese</option>
                    <option value="russian">Russian</option>
                    <option value="hindi">Hindi</option>
                    <option value="arabic">Arabic</option>
                  </select>
                </div>

                <br />
                <label
                  for="jobTitle"
                  class="labelForInputs"
                  style="margin-top: 15px"
                  >Job Title</label
                >
                <input
                  id="jobTitle"
                  placeholder="E.g., Senior Developer"
                  required
                  type="text"
                />
                <br />
                <label for="aboutTheEmployer" class="labelForInputs"
                  >ABOUT THE EMPLOYER</label
                >
                <input
                  id="aboutTheEmployer"
                  placeholder="E.g., Innovative tech company"
                  type="text"
                />
                <br />
                <label for="salary" class="labelForInputs">SALARY</label>
                <input id="salary" placeholder="E.g., $50,000" type="text" />
                <br />
                <label for="remote" class="labelForInputs">REMOTE</label>
                <input
                  id="remote"
                  placeholder="E.g., fully remote"
                  type="text"
                />
                <br />
                <label for="locationText" class="labelForInputs"
                  >LOCATION</label
                >
                <input
                  id="locationText"
                  placeholder="E.g., New York"
                  type="text"
                />
                <br />
                <label for="jobType" class="labelForInputs">JOB TYPE</label>
                <input id="jobType" placeholder="E.g., Full-time" type="text" />
                <br />
                <label for="employmentType" class="labelForInputs"
                  >EMPLOYMENT TYPE</label
                >
                <input
                  id="employmentType"
                  placeholder="E.g., Contract"
                  type="text"
                />
                <br />
                <label for="description" class="labelForInputs"
                  >DESCRIPTION</label
                >
                <input
                  id="description"
                  placeholder="E.g., Lead a team of..."
                  required
                  type="text"
                />
                <br />
                <label for="requirements" class="labelForInputs"
                  >REQUIREMENTS</label
                >
                <input
                  id="requirements"
                  placeholder="E.g., 5+ years of..."
                  type="text"
                />
                <br />
                <label for="keywords" class="labelForInputs">KEYWORDS</label>
                <input
                  id="keywords"
                  placeholder="E.g., Python, AI"
                  required
                  type="text"
                />
                <br />
                <label for="skills" class="labelForInputs">SKILLS</label>
                <input
                  id="skills"
                  placeholder="E.g., Problem-solving"
                  type="text"
                />
                <br />
                <label for="education" class="labelForInputs">EDUCATION</label>
                <input
                  id="education"
                  placeholder="E.g., Bachelor's"
                  type="text"
                />
                <br />
                <label for="personality" class="labelForInputs"
                  >PERSONALITY</label
                >
                <input
                  id="personality"
                  placeholder="E.g., Innovative"
                  type="text"
                />
              </div>
              <!-- <div>
            <input type="submit" value="Submit" />
          </div> -->
            </div>

            <div id="jobDescription" class="mainFormAndDescription">
              <div
                style="
                  display: flex;
                  width: 100%;
                  justify-content: space-between;
                "
              >
                <!-- <img
            src="/logo.png"
            width="60"
            height="60"
            style="margin-right: 10px; margin-bottom: 10px"
          /> -->

                <div
                  id="buttonContainerSaveAndEdit"
                  style="
                    display: flex;
                    align-items: center;
                    justify-content: space-evenly;
                    width: 100%;
                  "
                >
                  <!-- <a id="navbarTitle">Talent Scope</a> -->
                  <a id="edit" class="dropbtn" onclick="edit()">Edit</a>
                  <a id="saveAsPDF" class="dropbtn">Save as PDF</a>
                  <a onclick="downloadAsWord()" id="saveAsDOXS" class="dropbtn">
                    Save as DOCX
                  </a>

                  <script>
                    function downloadAsWord() {
                      // Convert the string to a Blob
                      var blob = new Blob([copyText], {
                        type: "application/msword",
                      });

                      // Create a download link
                      var link = document.createElement("a");
                      link.href = URL.createObjectURL(blob);

                      // Set the file name
                      link.download = "document.docx";

                      // Append the link to the body
                      document.body.appendChild(link);

                      // Trigger the click event to start the download
                      link.click();

                      // Remove the link from the DOM
                      document.body.removeChild(link);
                    }
                  </script>
                  <script>
                    let editing = false;
                    let editing_text;
                    async function edit() {
                      if (currentTextDbId !== null) {
                        editing = !editing;
                        if (editing) {
                          const texts = copyText.split("\n");

                          const container = document.getElementById(
                            "jobDescriptionResultcontainer"
                          );
                          const div = document.getElementById(
                            "jobDescriptionResult"
                          );
                          let text = div.textContent;
                          div.remove();
                          const textarea = document.createElement("textarea");
                          container.append(textarea);
                          textarea.id = "jobDescriptionResult";
                          const button = document.getElementById("edit");
                          button.innerHTML = "Stop editing";

                          let new_text = "";
                          for (const texte of texts)
                            new_text += `${texte} &NewLine;`;

                          editing_text = new_text;

                          textarea.innerHTML = new_text;
                          copyText = new_text;

                          textarea.addEventListener("input", function () {
                            copyText = textarea.value;
                          });
                          document.getElementById(
                            "mainFormSubmit"
                          ).disabled = true;
                        } else {
                          const texts = document
                            .getElementById("jobDescriptionResult")
                            .value.split("&NewLine;");

                          const container = document.getElementById(
                            "jobDescriptionResultcontainer"
                          );
                          const textarea = document.getElementById(
                            "jobDescriptionResult"
                          );
                          textarea.remove();
                          const a = document.createElement("a");
                          container.append(a);
                          a.id = "jobDescriptionResult";
                          const button = document.getElementById("edit");
                          button.innerHTML = "Edit";

                          let new_text = "";
                          for (const texte of texts) new_text += `${texte} \n`;

                          a.innerText = new_text;
                          copyText = new_text;
                          if (new_text && currentTextDbId !== null) {
                            axios
                              .post(baseUrl + "/updateText", {
                                email: localStorage.getItem("talentScopeEmail"),
                                pass: localStorage.getItem("talentScopePass"),
                                newText: new_text,
                                currentTextDbId: currentTextDbId,
                              })
                              .then((response) => {
                                const res = response.data;
                                if (res.message !== "ok") {
                                  console.error(
                                    "couldn't save the updated job description"
                                  );
                                }
                              })
                              .catch((error) => {
                                console.error(error);
                              });
                          }
                          document.getElementById(
                            "mainFormSubmit"
                          ).disabled = false;
                        }
                      } else {
                        document.getElementById("edit").innerText =
                          "Unable to edit";
                        clearInterval(editInterval);
                        var editInterval = setInterval(() => {
                          document.getElementById("edit").innerText = editing
                            ? "Stop editing and save"
                            : "Edit";
                        }, 3000);
                      }
                    }
                  </script>
                  <script>
                    document
                      .getElementById("saveAsPDF")
                      .addEventListener("click", async function () {
                        if (
                          copyText !== null &&
                          copyText !== "" &&
                          copyText.length
                        ) {
                          await axios
                            .post(baseUrl + "/pdf", {
                              data: copyText,
                            })
                            .then((response) => {
                              const blob = new Blob([response.data], {
                                type: "application/pdf",
                              });

                              const link = document.createElement("a");
                              link.href = window.URL.createObjectURL(blob);
                              link.download = "jobDescription.pdf";
                              link.click();
                            })
                            .catch((error) => {
                              console.error(error);
                            });
                        } else {
                          document.getElementById("saveAsPDF").innerText =
                            "Nothing to save as PDF";
                          clearInterval(pdfed);
                          var pdfed = setInterval(() => {
                            document.getElementById("saveAsPDF").innerText =
                              "Save as PDF";
                          }, 3000);
                        }
                      });
                  </script>
                </div>
              </div>
              <br />
              <div id="submitClearGroup">
                <!-- <a>Job Description</a> -->
                <input type="submit" value="SUBMIT" id="mainFormSubmit" />
                <a id="jobDescriptionCopy">COPY</a>
                <button id="jobDescriptionClear">CLEAR</button>
              </div>
              <div id="jobDescriptionResultcontainer">
                <div id="generatingSpinner" class="loader"></div>
                <a id="jobDescriptionResult"
                  >Submit the parameters to get a job description</a
                >
              </div>
            </div>

            <script>
              document.getElementById("generatingSpinner").style.display =
                "none";

              document
                .getElementById("jobDescriptionCopy")
                .addEventListener("click", () => {
                  if (copyText !== null && copyText !== "" && copyText.length) {
                    console.log(copyText);
                    navigator.clipboard.writeText(copyText);
                    document.getElementById("jobDescriptionCopy").innerText =
                      "COPY✅";
                    clearInterval(cpoied);
                    var cpoied = setInterval(() => {
                      document.getElementById("jobDescriptionCopy").innerText =
                        "COPY";
                    }, 3000);
                  } else {
                    document.getElementById("jobDescriptionCopy").innerText =
                      "COPY❌";
                    clearInterval(cpoied);
                    var cpoied = setInterval(() => {
                      document.getElementById("jobDescriptionCopy").innerText =
                        "COPY";
                    }, 3000);
                  }
                });

              document
                .getElementById("formName")
                .addEventListener("submit", async (event) => {
                  document.getElementById("mainFormSubmit").disabled = true;
                  document.getElementById("mainFormSubmit").value =
                    "GENERATING...";
                  jobDescriptionResult.innerText =
                    "Generating(it could take some time)...";
                  document.getElementById("generatingSpinner").style.display =
                    "block";
                  jobDescriptionResult.style.display = "none";
                  event.preventDefault();
                  jobTitle = document.getElementById("jobTitle").value;
                  aboutTheEmployer =
                    document.getElementById("aboutTheEmployer").value;
                  salary = document.getElementById("salary").value;
                  remote = document.getElementById("remote").value;
                  locationText = document.getElementById("locationText").value;
                  jobType = document.getElementById("jobType").value;
                  employmentType =
                    document.getElementById("employmentType").value;
                  description = document.getElementById("description").value;
                  requirements = document.getElementById("requirements").value;
                  keywords = document.getElementById("keywords").value;
                  skills = document.getElementById("skills").value;
                  education = document.getElementById("education").value;
                  personality = document.getElementById("personality").value;
                  lang = document.getElementById("lang").value;

                  await axios
                    .post(baseUrl + "/sendData", {
                      email: localStorage.getItem("talentScopeEmail"),
                      pass: localStorage.getItem("talentScopePass"),
                      jobTitle: jobTitle,
                      aboutTheEmployer: aboutTheEmployer,
                      salary: salary,
                      remote: remote,
                      locationText: locationText,
                      jobType: jobType,
                      employmentType: employmentType,
                      description: description,
                      requirements: requirements,
                      keywords: keywords,
                      skills: skills,
                      education: education,
                      personality: personality,
                      lang: lang,
                    })
                    .then((response) => {
                      const res = response.data;
                      jobDescriptionResult.innerText = res.message;
                      copyText = res.message;
                      document.getElementById(
                        "mainFormSubmit"
                      ).disabled = false;
                      document.getElementById("mainFormSubmit").value =
                        "SUBMIT";
                      currentTextDbId = res.databaseNumber;
                      document.getElementById(
                        "generatingSpinner"
                      ).style.display = "none";
                      jobDescriptionResult.style.display = "block";
                    })
                    .catch((error) => {
                      console.error(error);
                      document.getElementById(
                        "mainFormSubmit"
                      ).disabled = false;
                    });
                });

              document
                .getElementById("jobDescriptionClear")
                .addEventListener("click", () => {
                  jobDescriptionResult.value = "";
                  jobDescriptionResult.innerText =
                    "Submit the parameters to get a job description";
                  document.getElementById("jobTitle").value = "";
                  document.getElementById("jobTitle").value = "";
                  document.getElementById("aboutTheEmployer").value = "";
                  document.getElementById("salary").value = "";
                  document.getElementById("remote").value = "";
                  document.getElementById("locationText").value = "";
                  document.getElementById("jobType").value = "";
                  document.getElementById("employmentType").value = "";
                  document.getElementById("description").value = "";
                  document.getElementById("requirements").value = "";
                  document.getElementById("keywords").value = "";
                  document.getElementById("skills").value = "";
                  document.getElementById("education").value = "";
                  document.getElementById("personality").value = "";
                  document.getElementById("lang").value = "";
                  copyText = "";
                  currentTextDbId = null;
                });
            </script>
          </div>
        </form>
      </div>
    </div>

    <!-- sign in -->
    <div id="signIn">
      <div class="centerAccountForm">
        <form id="signInform" class="accountForm">
          <h2>Sign In</h2>
          <input type="email" required placeholder="Email" id="signInEmail" />
          <input
            type="password"
            required
            placeholder="Password"
            id="signInPass"
          />
          <p class="warningMsg" id="signInIncorrectNameOrPassword">
            ⚠️Incorrect name or password
          </p>
          <p id="forgotPassSignUp">Forgot your password?</p>
          <p id="dontHaveAnAccountSignUp">Don't have an account? Sign Up.</p>
          <input class="accountFormSubmit" type="submit" value="Sign In" />
        </form>
      </div>
      <script>
        let signInIncorrectNameOrPassword = document.getElementById(
          "signInIncorrectNameOrPassword"
        );
        signInIncorrectNameOrPassword.style.display = "none";

        document
          .getElementById("dontHaveAnAccountSignUp")
          .addEventListener("click", (event) => {
            signIn.style.display = "none";
            signUp.style.display = "block";
          });

        document
          .getElementById("forgotPassSignUp")
          .addEventListener("click", (event) => {
            signIn.style.display = "none";
            fPass.style.display = "block";
          });

        document
          .getElementById("signInform")
          .addEventListener("submit", (event) => {
            event.preventDefault();
            let signInEmail = document.getElementById("signInEmail").value;
            let signInPass = document.getElementById("signInPass").value;
            axios
              .post(baseUrl + "/signInSendData", {
                email: signInEmail,
                pass: signInPass,
              })
              .then((response) => {
                const res = response.data;
                if (res.message === "account verifyed") {
                  // console.log(signInEmail, signInPass);
                  localStorage.setItem("talentScopeEmail", signInEmail);
                  localStorage.setItem("talentScopePass", signInPass);
                  signIn.style.display = "none";
                  home.style.display = "block";
                  let url = window.location.href;
                  if (url.endsWith("#payments")) {
                    console.log("redirect to payments");
                  } else if (url.endsWith("#account")) {
                    home.style.display = "none";
                    myAccount.style.display = "block";
                  } else {
                    validate();
                  }
                  document.getElementById("navbarEmail").innerText =
                    signInEmail;
                }
                if (res.message === "wrong name or pass") {
                  signInIncorrectNameOrPassword.style.display = "block";
                  clearInterval(signInEmailTakenInterval);
                  var signInEmailTakenInterval = setInterval(() => {
                    signInIncorrectNameOrPassword.style.display = "none";
                  }, 10000);
                }
              })
              .catch((error) => {
                console.error(error);
              });
          });
      </script>
    </div>

    <!-- sign up -->
    <div id="signUp">
      <div class="centerAccountForm">
        <form id="signUpform" class="accountForm">
          <h2>Sign Up</h2>
          <input type="email" required placeholder="Email" id="signUpEmail" />
          <input
            type="password"
            required
            placeholder="Password"
            id="signUpPass"
          />
          <p class="warningMsg" id="signUpEmailTaken">
            ⚠️This email has already been used
          </p>
          <input class="accountFormSubmit" type="submit" value="Sign Up" />
        </form>
      </div>
      <script>
        let signUpEmailTaken = document.getElementById("signUpEmailTaken");
        signUpEmailTaken.style.display = "none";

        document
          .getElementById("signUpform")
          .addEventListener("submit", (event) => {
            event.preventDefault();
            let signUpEmail = document.getElementById("signUpEmail").value;
            let signUpPass = document.getElementById("signUpPass").value;
            axios
              .post(baseUrl + "/signUpSendData", {
                email: signUpEmail,
                pass: signUpPass,
              })
              .then((response) => {
                const res = response.data;
                if (res.message === "account created") {
                  // console.log(signUpEmail, signUpPass);
                  localStorage.setItem("talentScopeEmail", signUpEmail);
                  localStorage.setItem("talentScopePass", signUpPass);
                  signUp.style.display = "none";
                  home.style.display = "block";
                  let url = window.location.href;
                  if (url.endsWith("#payments")) {
                    console.log("redirect to payments");
                  } else if (url.endsWith("#account")) {
                    home.style.display = "none";
                    myAccount.style.display = "block";
                  } else {
                    validate();
                  }
                  document.getElementById("navbarEmail").innerText =
                    signUpEmail;
                }
                if (res.message === "email taken") {
                  signUpEmailTaken.style.display = "block";
                  clearInterval(signUpEmailTakenInterval);
                  var signUpEmailTakenInterval = setInterval(() => {
                    signUpEmailTaken.style.display = "none";
                  }, 7000);
                }
              })
              .catch((error) => {
                console.error(error);
              });
          });
      </script>
    </div>

    <!-- forgot password -->
    <div id="fPass">
      <div class="centerAccountForm">
        <form id="fPassform" class="accountForm">
          <h2>Forgot your password?</h2>
          <input type="email" required placeholder="Email" id="fPassEmail" />
          <input
            type="password"
            required
            placeholder="New password"
            id="fPassPass"
          />
          <input
            class="accountFormSubmit"
            type="submit"
            value="Send Confirmation Email"
          />
          <br />
          <a id="checkEailMessage"
            >Now check your email for a comfirmation, please</a
          >
        </form>
      </div>
      <script>
        document.getElementById("checkEailMessage").style.display = "none";
        document
          .getElementById("fPassform")
          .addEventListener("submit", (event) => {
            event.preventDefault();
            let signUpEmail = document.getElementById("fPassEmail").value;
            let signUpPass = document.getElementById("fPassPass").value;
            axios
              .post(baseUrl + "/fPassSendData", {
                email: signUpEmail,
                pass: signUpPass,
              })
              .then((response) => {
                const res = response.data;
                if (res.message === "ok") {
                  document.getElementById("fPassEmail").value = "";
                  document.getElementById("fPassPass").value = "";
                  document.getElementById("checkEailMessage").style.display =
                    "block";
                } else {
                  alert("Error, please try again");
                }
              })
              .catch((error) => {
                console.error(error);
              });
          });
      </script>
    </div>

    <!-- my account -->
    <div id="myAccount">
      <!-- <div class="centerAccountForm"> -->
      <!-- <div class="accountForm"> -->
      <button class="accountButton" id="accountBack">Back</button>
      <br />
      <!-- </div> -->
      <!-- </div> -->

      <br />
      <input
        id="accountFirstName"
        class="accountButton"
        placeholder="First Name"
        type="text"
      />

      <input
        id="accountLastName"
        class="accountButton"
        placeholder="Last Name"
        type="text"
      />
      <br />

      <input
        id="accountLacation"
        class="accountButton"
        placeholder="Location"
        type="text"
      />
      <br />

      <input
        id="accountCompany"
        class="accountButton"
        placeholder="Company"
        type="text"
      />
      <br />
      <input
        id="accountNumner"
        class="accountButton"
        placeholder="Number"
        type="text"
      />
      <br />

      <input
        class="accountButton"
        placeholder="Email"
        type="email"
        id="navbarEmail"
      />
      <br />

      <button class="accountButton" id="accountUpdateInfo">Update</button>
      <br />
      <script>
        axios
          .post(baseUrl + "/getAccountInfo", {
            email: localStorage.getItem("talentScopeEmail"),
            pass: localStorage.getItem("talentScopePass"),
          })
          .then((response) => {
            const res = response.data;
            console.log(res);
            if (res.account && res.message === "ok") {
              document.getElementById("accountFirstName").value =
                res.account.firstName || "";
              document.getElementById("accountLastName").value =
                res.account.lastName || "";
              document.getElementById("accountLacation").value =
                res.account.accountLocation || "";
              document.getElementById("accountCompany").value =
                res.account.company || "";
              document.getElementById("accountNumner").value =
                res.account.number || "";
              document.getElementById("navbarEmail").value =
                res.account.email || "";
              if (
                res.account.email &&
                res.account.email !== "" &&
                res.account.email.length > 2
              ) {
                localStorage.setItem("talentScopeEmail", res.account.email);
              }
            }
          })
          .catch((error) => {
            console.error(error);
          });
        document
          .getElementById("accountUpdateInfo")
          .addEventListener("click", () => {
            let accountFirstName =
              document.getElementById("accountFirstName").value;
            let accountLastName =
              document.getElementById("accountLastName").value;
            let accountLocation =
              document.getElementById("accountLacation").value;
            let accountCompany =
              document.getElementById("accountCompany").value;
            let accountNumber = document.getElementById("accountNumner").value;
            let accountEmail = document.getElementById("navbarEmail").value;
            axios
              .post(baseUrl + "/updateAccountInfo", {
                email: localStorage.getItem("talentScopeEmail"),
                pass: localStorage.getItem("talentScopePass"),
                firstName: accountFirstName,
                lastName: accountLastName,
                accountLocation: accountLacation,
                company: accountCompany,
                number: accountNumber,
                email: accountEmail,
              })
              .then((response) => {})
              .catch((error) => {
                console.error(error);
              });
          });
      </script>

      <button class="accountButton" id="accountGoPayments">My subscribtions</button>
      <button class="accountButton">Active</button>
      <button class="accountButton">Cancel</button>
      <br />
      <button class="accountButton">My plan</button>
      <button class="accountButton">Monthly</button>
      <button class="accountButton">Yearly</button>
      <br />
      <button
        style="background-color: rgb(240, 215, 219); border-color: crimson"
        class="accountButton"
        id="logoutButton"
      >
        Logout
      </button>
      <br />
      <br />
      <br />
      <script>
        document.getElementById("navbarEmail").value =
          localStorage.getItem("talentScopeEmail");

        document
          .getElementById("accountGoPayments")
          .addEventListener("click", () => {
            myAccount.style.display = "none";
            payments.style.display = "block";
          });

        document
          .getElementById("logoutButton")
          .addEventListener("click", () => {
            localStorage.setItem("talentScopeEmail", null);
            localStorage.setItem("talentScopePass", null);
            home.style.display = "none";
            signIn.style.display = "block";
            location.reload();
          });

        document.getElementById("accountBack").addEventListener("click", () => {
          myAccount.style.display = "none";
          home.style.display = "block";
          validate();
        });
      </script>
    </div>

    <!-- payments -->
    <div id="payments">
      <div class="all-payments">
        <div class="plans">
          <div class="card">
            <div class="best-payment">Best Value</div>  
            <div class="card-h2">Yearly</div>
              <div class="price">
                  <div class="dollar-payment">$</div>
                  <span>29.99</span>
              </div>
            <p>$359 Every Year</p>
            <button class="select">Select</button>
            <button id="payentsButton">29.99</button>
            <script>
              document
                .getElementById("payentsButton")
                .addEventListener("click", () => {
                  axios
                    .post(baseUrl + "/create-checkout-session", {
                      email: localStorage.getItem("talentScopeEmail"),
                      pass: localStorage.getItem("talentScopePass"),
                    })
                    .then((response) => {
                      const { url } = response.data;
                      if (url) {
                        window.location = url;
                      }
                    })
                    .catch((error) => {
                      console.error(error);
                    });
                });
            </script>
          </div>
          <div class="card">
            <div class="empty-payment"></div> 
            <div class="card-h2">Monthly</div>
            <div class="price">
              <div class="dollar-payment">$</div>
              <span>39.99</span>
            </div>
            <p>Every Month</p>
            <button class="select">Select</button>
            <button id="payentsButton2">39.99</button>
            <script>
              document
                .getElementById("payentsButton2")
                .addEventListener("click", () => {
                  axios
                    .post(baseUrl + "/create-checkout-session2", {
                      email: localStorage.getItem("talentScopeEmail"),
                      pass: localStorage.getItem("talentScopePass"),
                    })
                    .then((response) => {
                      const { url } = response.data;
                      if (url) {
                        window.location = url;
                      }
                    })
                    .catch((error) => {
                      console.error(error);
                    });
                });
            </script>
          </div>
        </div>
        <button id="paymentsBack">Back</button>
        <script>
          document
            .getElementById("paymentsBack")
            .addEventListener("click", () => {
              payments.style.display = "none";
              myAccount.style.display = "block";
            });
        </script>
      </div>
    </div>
    <script>
      window.addEventListener("DOMContentLoaded", function () {
        function adjustHeight() {
          var screenWidth = window.innerWidth;
          console.log(screenWidth);
          if (screenWidth < 700) {
            document.getElementById("saveAsPDF").style.height = "auto";
            document.getElementById("saveAsDOXS").style.height = "auto";
            document.getElementById("edit").style.height = "auto";
          } else {
            document.getElementById("saveAsPDF").style.height = "20px";
            document.getElementById("saveAsDOXS").style.height = "20px";
            document.getElementById("edit").style.height = "20px";
          }
        }

        adjustHeight();

        window.addEventListener("resize", adjustHeight);
      });
    </script>

    <script>
      var signUp = document.getElementById("signUp");
      var home = document.getElementById("home");
      var signIn = document.getElementById("signIn");
      var fPass = document.getElementById("fPass");
      var myAccount = document.getElementById("myAccount");
      var payments = document.getElementById("payments");
      home.style.display = "none";
      signIn.style.display = "none";
      signUp.style.display = "none";
      fPass.style.display = "none";
      myAccount.style.display = "none";
      payments.style.display = "none";
      let emailInit = localStorage.getItem("talentScopeEmail");
      let passInit = localStorage.getItem("talentScopePass");
      let url = window.location.href;
      if (url.endsWith("#payments")) {
        console.log("redirect to payments");
      } else if (url.endsWith("#account")) {
        myAccount.style.display = "block";
      }
      if (emailInit && passInit && emailInit !== "null") {
        axios
          .post(baseUrl + "/initialLogin", {
            email: emailInit,
            pass: passInit,
          })
          .then((response) => {
            const res = response.data;
            if (res.message !== "ok") {
              signIn.style.display = "block";
              home.style.display = "none";
            } else {
              home.style.display = "block";
              if (url.endsWith("#payments")) {
                console.log("redirect to payments");
              } else if (url.endsWith("#account")) {
                home.style.display = "none";
                myAccount.style.display = "block";
              } else {
                validate();
              }
            }
          })
          .catch((error) => {
            console.error(error);
          });
      } else {
        signIn.style.display = "block";
      }
    </script>
  </body>
</html>
